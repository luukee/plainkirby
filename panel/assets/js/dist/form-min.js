!function($){$.fn.date=function(){return this.each(function(){if($(this).data("pikaday"))return $(this);var t=$(this).attr("type","text"),e=t.next(),a=t.data("format"),n=t.val(),r=n?moment(n).format(a):null;if(t.attr("placeholder",a),t.val(r),t.is("[readonly]"))return!1;t.on("change",function(){var n=t.val();n?e.val(moment(n,a).format("YYYY-MM-DD")):e.val("")});var i=new Pikaday({field:this,firstDay:1,format:a,i18n:t.data("i18n"),onSelect:function(t){e.val(moment(t).format("YYYY-MM-DD"))}});$(this).data("pikaday",i)})}}(jQuery),function($){$.fn.imagefield=function(){return this.each(function(){var t=$(this);if(t.data("imagefield"))return!0;t.data("imagefield",!0);var e=t.find("select"),a=t.find(".input-preview figure"),n=a.parent("a");e.on("keydown change",function(){var t=e.find("option:selected"),r=t.data("url"),i=t.data("thumb");""===t.val()&&(r="#"),i?a.attr("style","background-image: url("+i+")"):a.attr("style","background-image: none"),n.attr("href",r)}).trigger("change"),t.find(".input-preview").on("click",function(){if("#"==$(this).attr("href"))return!1}),t.find(".input").droppable({hoverClass:"over",accept:$(".sidebar .draggable-file"),drop:function(t,e){$(this).find("select").val(e.draggable.data("helper")).trigger("change")}})})}}(jQuery),function($){var t=function(t){var e=$(t),a=e.data("style"),n=e.data("api"),r=e.data("sortable"),i="table"==a?e.find(".structure-table tbody"):e.find(".structure-entries");if(!1===r)return!1;i.sortable({helper:function(t,e){return e.children().each(function(){$(this).width($(this).width())}),e.addClass("structure-sortable-helper")},update:function(){var t=[];$.each($(this).sortable("toArray"),function(e,a){t.push(a.replace("structure-entry-",""))}),$.post(n,{ids:t},function(){app.content.reload()})}})};$.fn.structure=function(){return this.each(function(){if($(this).data("structure"))return $(this);var e=new t(this);return $(this).data("structure",e),$(this)})}}(jQuery),function($){$.fn.counter=function(){return this.each(function(){var t=$(this);if(t.data("counter"))return t;var e=t.parent(".field").find(".input"),a=$.trim(e.val()).length,n=e.data("max"),r=e.data("min");e.keyup(function(){a=$.trim(e.val()).length,t.text(a+(n?"/"+n:"")),n&&a>n||r&&a<r?t.addClass("outside-range"):t.removeClass("outside-range")}).trigger("keyup"),t.data("counter",!0)})}}(jQuery),function($){$.fn.editor=function(){return this.each(function(){if($(this).data("editor"))return $(this);var t=$(this),e=t.parent().find(".field-buttons");t.autosize(),e.find(".btn").on("click.editorButton",function(e){t.focus();var a=$(this);if(a.data("action"))app.modal.open(a.data("action"),window.location.href);else{var n=t.getSelection(),r=a.data("tpl"),i=a.data("text");n.length>0&&(i=n);var o=r.replace("{text}",i);t.insertAtCursor(o),t.trigger("autosize.resize")}return!1}),e.find("[data-editor-shortcut]").each(function(e,a){var n=$(this).data("editor-shortcut"),r=function(t){return $(a).trigger("click"),!1};t.bind("keydown",n,r),n.match(/meta\+/)&&t.bind("keydown",n.replace("meta+","ctrl+"),r)}),t.data("editor",!0)})}}(jQuery),function($){$.fn.urlfield=function(){return this.each(function(){var t=$(this);if(!t.data("urlfield")){t.data("urlfield",!0);var e=t.next(".field-icon");e.css({cursor:"pointer","pointer-events":"auto"}),e.on("click",function(){var e=$.trim(t.val());""!==e&&t.is(":valid")?window.open(e):t.focus()})}})}}(jQuery);